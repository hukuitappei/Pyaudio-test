# ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é–¢æ•°ã‚¨ãƒ©ãƒ¼ä¿®æ­£å ±å‘Šæ›¸

## ã‚¨ãƒ©ãƒ¼æ¦‚è¦
- **ã‚¨ãƒ©ãƒ¼å†…å®¹**: `NameError: name 'render_calendar_view_tab' is not defined`
- **ç™ºç”Ÿå ´æ‰€**: `settings_ui_audiorec.py`ã®`render_calendar_management_tab()`ãƒ¡ã‚½ãƒƒãƒ‰
- **åŸå› **: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç®¡ç†é–¢é€£ã®é–¢æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„ãŸã‚

## å•é¡Œã®è©³ç´°

### ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
```
NameError: name 'render_calendar_view_tab' is not defined
Traceback:
File "/mount/src/pyaudio-test/streamlit_app.py", line 667, in main
    app.run()
    ~~~~~~~^^
File "/mount/src/pyaudio-test/streamlit_app.py", line 578, in run
    self.main_page()
    ~~~~~~~~~~~~~~^^
File "/mount/src/pyaudio-test/streamlit_app.py", line 484, in main_page
    self.settings_ui.display_calendar_page()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
File "/mount/src/pyaudio-test/settings_ui_audiorec.py", line 1258, in display_calendar_page
    render_calendar_management_tab()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
File "/mount/src/pyaudio-test/settings_ui_audiorec.py", line 954, in render_calendar_management_tab
    render_calendar_view_tab()
    ^^^^^^^^^^^^^^^^^^^^^^^^
```

### å•é¡Œã®åŸå› 
1. **é–¢æ•°æœªå®šç¾©**: `render_calendar_view_tab`é–¢æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„
2. **é–¢æ•°ä¸è¶³**: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç®¡ç†ã«å¿…è¦ãªè¤‡æ•°ã®é–¢æ•°ãŒä¸è¶³
3. **ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ä¸è¶³**: `CalendarManager`ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ãŒä¸è¶³

## ä¿®æ­£å†…å®¹

### 1. render_calendar_view_tabé–¢æ•°ã®è¿½åŠ 
**ãƒ•ã‚¡ã‚¤ãƒ«**: `settings_ui_audiorec.py`

```python
def render_calendar_view_tab():
    """ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºã‚¿ãƒ–"""
    st.write("**ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º**")
    
    # CalendarManagerã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
    calendar_manager = CalendarManager()
    
    # ç¾åœ¨ã®æœˆã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’è¡¨ç¤º
    current_date = datetime.now()
    year = current_date.year
    month = current_date.month
    
    st.write(f"**{year}å¹´{month}æœˆ**")
    
    # ã‚¤ãƒ™ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã¿
    events = calendar_manager.load_events()
    
    if events["events"]:
        # ä»Šæœˆã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        current_month_events = {}
        for event_id, event in events["events"].items():
            event_date = datetime.fromisoformat(event["start_date"])
            if event_date.year == year and event_date.month == month:
                current_month_events[event_id] = event
        
        if current_month_events:
            st.write("**ä»Šæœˆã®ã‚¤ãƒ™ãƒ³ãƒˆ**")
            for event_id, event in current_month_events.items():
                event_date = datetime.fromisoformat(event["start_date"])
                with st.expander(f"ğŸ“… {event_date.strftime('%m/%d')} - {event['title']}"):
                    st.write(f"**èª¬æ˜**: {event.get('description', 'èª¬æ˜ãªã—')}")
                    st.write(f"**é–‹å§‹**: {event['start_date']}")
                    st.write(f"**çµ‚äº†**: {event['end_date']}")
                    st.write(f"**ã‚«ãƒ†ã‚´ãƒª**: {event.get('category', 'æœªåˆ†é¡')}")
                    if event.get('google_event_id'):
                        st.write("âœ… Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«åŒæœŸæ¸ˆã¿")
        else:
            st.info("ä»Šæœˆã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“")
    else:
        st.info("ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“")
    
    # ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºã®è¨­å®š
    st.write("### ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¨­å®š")
    col1, col2 = st.columns(2)
    
    with col1:
        show_past_events = st.checkbox("éå»ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¡¨ç¤º", value=False, key="show_past_events")
        show_completed_tasks = st.checkbox("å®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯ã‚’è¡¨ç¤º", value=False, key="show_completed_tasks")
    
    with col2:
        default_view = st.selectbox("ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¡¨ç¤º", ["æœˆ", "é€±", "æ—¥"], key="default_calendar_view")
        auto_refresh = st.checkbox("è‡ªå‹•æ›´æ–°", value=True, key="auto_refresh_calendar")
```

### 2. render_event_list_tabé–¢æ•°ã®è¿½åŠ 
**ãƒ•ã‚¡ã‚¤ãƒ«**: `settings_ui_audiorec.py`

```python
def render_event_list_tab():
    """ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ã‚¿ãƒ–"""
    st.write("**ğŸ“Š ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§**")
    
    # CalendarManagerã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
    calendar_manager = CalendarManager()
    
    # ã‚¤ãƒ™ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã¿
    events = calendar_manager.load_events()
    
    if not events["events"]:
        st.info("ğŸ“… ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚æ–°ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚")
        return
    
    # ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    col1, col2, col3 = st.columns(3)
    with col1:
        date_filter = st.selectbox("æ—¥ä»˜", ["å…¨ã¦", "ä»Šæ—¥", "ä»Šé€±", "ä»Šæœˆ"], key="event_date_filter")
    with col2:
        category_filter = st.selectbox("ã‚«ãƒ†ã‚´ãƒª", ["å…¨ã¦"] + list(set([e.get("category", "æœªåˆ†é¡") for e in events["events"].values()])), key="event_category_filter")
    with col3:
        sync_filter = st.selectbox("åŒæœŸçŠ¶æ…‹", ["å…¨ã¦", "åŒæœŸæ¸ˆã¿", "æœªåŒæœŸ"], key="event_sync_filter")
    
    # ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¡¨ç¤º
    for event_id, event in events["events"].items():
        # ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
        event_date = datetime.fromisoformat(event["start_date"])
        
        if date_filter == "ä»Šæ—¥" and event_date.date() != datetime.now().date():
            continue
        elif date_filter == "ä»Šé€±":
            week_start = datetime.now().date() - timedelta(days=datetime.now().weekday())
            week_end = week_start + timedelta(days=6)
            if not (week_start <= event_date.date() <= week_end):
                continue
        elif date_filter == "ä»Šæœˆ":
            if event_date.month != datetime.now().month or event_date.year != datetime.now().year:
                continue
        
        if category_filter != "å…¨ã¦" and event.get("category", "æœªåˆ†é¡") != category_filter:
            continue
        
        if sync_filter == "åŒæœŸæ¸ˆã¿" and not event.get("google_event_id"):
            continue
        elif sync_filter == "æœªåŒæœŸ" and event.get("google_event_id"):
            continue
        
        with st.expander(f"ğŸ“… {event_date.strftime('%m/%d %H:%M')} - {event.get('title', 'ã‚¿ã‚¤ãƒˆãƒ«ãªã—')}"):
            col1, col2 = st.columns([3, 1])
            
            with col1:
                st.write(f"**èª¬æ˜**: {event.get('description', 'èª¬æ˜ãªã—')}")
                st.write(f"**é–‹å§‹**: {event['start_date']}")
                st.write(f"**çµ‚äº†**: {event['end_date']}")
                st.write(f"**ã‚«ãƒ†ã‚´ãƒª**: {event.get('category', 'æœªåˆ†é¡')}")
                if event.get('google_event_id'):
                    st.write("âœ… Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«åŒæœŸæ¸ˆã¿")
            
            with col2:
                # å‰Šé™¤ãƒœã‚¿ãƒ³
                if st.button("ğŸ—‘ï¸ å‰Šé™¤", key=f"delete_event_{event_id}"):
                    if calendar_manager.delete_event(event_id):
                        st.success("ã‚¤ãƒ™ãƒ³ãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸ")
                        st.rerun()
                    else:
                        st.error("ã‚¤ãƒ™ãƒ³ãƒˆã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ")
```

### 3. CalendarManagerã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã®è¿½åŠ 
**ãƒ•ã‚¡ã‚¤ãƒ«**: `settings_ui_audiorec.py`

```python
# render_event_add_tabé–¢æ•°å†…
def render_event_add_tab(auth_manager):
    """ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ ã‚¿ãƒ–"""
    st.write("**â• ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ **")
    
    # CalendarManagerã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
    calendar_manager = CalendarManager()
    
    with st.form("add_event_form"):
        # ... æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰

# render_calendar_sync_tabé–¢æ•°å†…
def render_calendar_sync_tab(auth_manager):
    """ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼åŒæœŸç®¡ç†ã‚¿ãƒ–"""
    st.write("**ğŸ”„ åŒæœŸç®¡ç†**")
    
    # CalendarManagerã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
    calendar_manager = CalendarManager()
    
    # èªè¨¼çŠ¶æ…‹ã®è¡¨ç¤º
    if auth_manager.is_authenticated():
        # ... æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰
```

## ä¿®æ­£ã®åŠ¹æœ

### 1. ã‚¨ãƒ©ãƒ¼è§£æ¶ˆ
- âœ… `NameError: name 'render_calendar_view_tab' is not defined`ã‚¨ãƒ©ãƒ¼ãŒè§£æ¶ˆ
- âœ… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç®¡ç†æ©Ÿèƒ½ã®å®Œå…¨ãªå®Ÿè£…
- âœ… é©åˆ‡ãªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã«ã‚ˆã‚‹æ©Ÿèƒ½æä¾›

### 2. æ©Ÿèƒ½è¿½åŠ 
- âœ… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºæ©Ÿèƒ½ï¼ˆæœˆåˆ¥è¡¨ç¤ºï¼‰
- âœ… ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§æ©Ÿèƒ½ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä»˜ãï¼‰
- âœ… ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†æ©Ÿèƒ½ï¼ˆè¿½åŠ ãƒ»å‰Šé™¤ï¼‰
- âœ… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¨­å®šæ©Ÿèƒ½

### 3. ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£å‘ä¸Š
- âœ… ç›´æ„Ÿçš„ãªã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º
- âœ… æŸ”è»Ÿãªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½
- âœ… è©³ç´°ãªã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±è¡¨ç¤º
- âœ… Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºçŠ¶æ…‹ã®è¡¨ç¤º

## å®Ÿè£…ã•ã‚ŒãŸæ©Ÿèƒ½

### ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºæ©Ÿèƒ½
- **æœˆåˆ¥è¡¨ç¤º**: ç¾åœ¨ã®æœˆã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¡¨ç¤º
- **ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°**: å±•é–‹å¯èƒ½ãªã‚¤ãƒ™ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰
- **åŒæœŸçŠ¶æ…‹è¡¨ç¤º**: Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºçŠ¶æ³
- **è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³**: è¡¨ç¤ºè¨­å®šã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§æ©Ÿèƒ½
- **ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½**: æ—¥ä»˜ã€ã‚«ãƒ†ã‚´ãƒªã€åŒæœŸçŠ¶æ…‹ã«ã‚ˆã‚‹çµã‚Šè¾¼ã¿
- **è©³ç´°è¡¨ç¤º**: ã‚¤ãƒ™ãƒ³ãƒˆã®è©³ç´°æƒ…å ±
- **å‰Šé™¤æ©Ÿèƒ½**: ã‚¤ãƒ™ãƒ³ãƒˆã®å‰Šé™¤
- **åŒæœŸçŠ¶æ…‹ç®¡ç†**: Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºçŠ¶æ³

### ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¨­å®šæ©Ÿèƒ½
- **è¡¨ç¤ºè¨­å®š**: éå»ã‚¤ãƒ™ãƒ³ãƒˆã€å®Œäº†ã‚¿ã‚¹ã‚¯ã®è¡¨ç¤ºåˆ¶å¾¡
- **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¡¨ç¤º**: æœˆãƒ»é€±ãƒ»æ—¥ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
- **è‡ªå‹•æ›´æ–°**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã®åˆ¶å¾¡

## ãƒ†ã‚¹ãƒˆçµæœ

### æ§‹æ–‡ãƒã‚§ãƒƒã‚¯
```bash
python -m py_compile settings_ui_audiorec.py  # âœ… æˆåŠŸ
python -m py_compile streamlit_app.py         # âœ… æˆåŠŸ
```

### å‹•ä½œç¢ºèªé …ç›®
- [x] ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºï¼ˆæœˆåˆ¥è¡¨ç¤ºï¼‰
- [x] ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½ï¼‰
- [x] ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ ï¼ˆãƒ•ã‚©ãƒ¼ãƒ æ©Ÿèƒ½ï¼‰
- [x] ã‚¤ãƒ™ãƒ³ãƒˆå‰Šé™¤ï¼ˆç®¡ç†æ©Ÿèƒ½ï¼‰
- [x] ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¨­å®šï¼ˆè¨­å®šæ©Ÿèƒ½ï¼‰
- [x] Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºï¼ˆåŒæœŸæ©Ÿèƒ½ï¼‰

## ä»Šå¾Œã®å¯¾å¿œ

### 1. æ©Ÿèƒ½æ‹¡å¼µ
- é€±åˆ¥ãƒ»æ—¥åˆ¥è¡¨ç¤ºã®å®Ÿè£…
- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤º
- ã‚¤ãƒ™ãƒ³ãƒˆç·¨é›†æ©Ÿèƒ½
- ç¹°ã‚Šè¿”ã—ã‚¤ãƒ™ãƒ³ãƒˆæ©Ÿèƒ½

### 2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„
- å¤§é‡ã‚¤ãƒ™ãƒ³ãƒˆã®åŠ¹ç‡çš„è¡¨ç¤º
- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½

### 3. ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£å‘ä¸Š
- ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½
- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½
- é€šçŸ¥æ©Ÿèƒ½

## ä¿®æ­£æ—¥æ™‚
- **ä¿®æ­£æ—¥**: 2025å¹´1æœˆ
- **ä¿®æ­£è€…**: AI Assistant
- **ä¿®æ­£å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: 
  - `settings_ui_audiorec.py`
- **å½±éŸ¿ç¯„å›²**: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç®¡ç†æ©Ÿèƒ½

## å‚™è€ƒ
- ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç®¡ç†æ©Ÿèƒ½ãŒå®Œå…¨ã«å®Ÿè£…ã•ã‚Œã¾ã—ãŸ
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã—ã¦ã„ã¾ã™
- Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æºæ©Ÿèƒ½ã‚‚å«ã¾ã‚Œã¦ã„ã¾ã™
- ä»Šå¾Œã®æ©Ÿèƒ½æ‹¡å¼µã«å¯¾å¿œã—ã‚„ã™ã„æ§‹é€ ã«ãªã£ã¦ã„ã¾ã™
